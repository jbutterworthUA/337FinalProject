<!--
    File: ratings.html
    Desc: 
-->
<!DOCTYPE html>
<html>
    <head>
        <title>Watchlist</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div class="menu-bar">
            <a href="./start.html">Log Out</a>
            <a href="./catalog.html">Back to Catalog</a>
            <a href="./watchlist.html">Back to Watchlist</a>
        </div>

        <h1>Watched Movie Ratings</h1>

        <table>
            <tr>
                <th>Title</th><th>Description</th><th>Rating</th>
            </tr>
            <tbody id="ratedMoviesTable"></tbody>
        </table>
    </body>

    <script>

        function fillTable() {
                const currentUser = localStorage.getItem("currentUser");

                fetch(`/databases/user_catalogs/${currentUser}_catalog.json`)
                    .then(res => res.json())
                    .then(catalog => {
                        const table = document.getElementById("ratedMoviesTable");

                        for (let movie of catalog) {
                            if (movie.rating != 0) {
                                const row = document.createElement("tr");
                                
                                row.innerHTML = `
                                    <td>${movie.title}</td>
                                    <td>${movie.description}</td>
                                    <td>${movie.rating}</td>
                                `;

                                table.appendChild(row);
                            }
                        }
                    })
                    .catch(err => console.error("Error loading watchlist:", err));
            }

            fillTable(); 

    </script>

</html>
